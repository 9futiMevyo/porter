version: v2beta1

builds:
- name: porter
  method: docker
  dockerfile: ./docker/Dockerfile
  env:
    import_from:
      - default/base-env

apps:
- name: porter-dashboard
  depends_on:
    - postgres
  helm_chart:
    name: web
  build_ref: porter
  helm_values:
    container:
      port: 8080
    resources:
      requests:
        cpu: 400m
        memory: 512Mi

addons:
- name: postgres
  helm_chart:
    name: postgresql
  helm_values:
    postgresqlUsername: porter
    postgresqlPassword: porter
    postgresqlDatabase: porter
    image:
      tag: 13.6.0-debian-10-r55
